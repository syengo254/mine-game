(()=>{"use strict";const t=(t,e)=>{let i=t.position.x>=e.position.x&&t.position.x<=e.position.x+e.width,s=t.position.y<=e.position.y+e.height&&t.position.y>=e.position.y;return!(!i||!s)};class e{constructor(t,e=!1){this.player=t,this.isEnemy=e,this.scale=.25,this.width=38*this.scale,this.height=89*this.scale,e?(this.y=t.position.y+this.height,this.speed=5,this.image=document.getElementById("enemy_missile")):(this.y=t.position.y-this.height,this.speed=-7.5,this.image=document.getElementById("missile")),this.position={x:t.position.x+t.width/2-this.width/2,y:this.y},this.markedForDeletion=!1}update(){this.position.y+=this.speed,!this.isEnemy&&this.position.y<=-this.height&&(this.markedForDeletion=!0),this.isEnemy&&this.position.y>this.player.game.gameHeight+this.height&&(this.markedForDeletion=!0),this.isEnemy?t(this,this.player.game.player)&&(console.log("player hit"),this.markedForDeletion=!0,this.player.game.player.lives-=1):this.player.game.enemies.forEach((e=>{t(this,e)&&(console.log("enemy hit"),e.markedForDeletion=!0,this.markedForDeletion=!0,this.player.game.score+=Math.floor(500*this.player.lives/3),this.player.ammo+=.5)}))}draw(t){t.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}class i{constructor(t){this.game=t,this.image=document.getElementById("enemy"),this.scale=.16,this.width=Math.floor(191*this.scale),this.height=Math.floor(266*this.scale);let e=Math.ceil(10*Math.random())/10,i=Math.ceil(10*Math.random())/10;this.speedY=1+i,this.speedX=Math.floor(10*Math.random())>5?-2:2,this.speedX+=e,this.reset(),this.fireRate=1e3}reset(){this.position={x:Math.ceil(Math.random()*(this.game.gameWidth-this.width)),y:Math.floor(100*Math.random())},this.lastFired=0}move(){this.position.y+=this.speedY,this.position.x+=this.speedX,(this.position.y>=this.game.gameHeight/2||this.position.y<=0)&&(this.speedY*=-1),(this.position.x<0||this.position.x>this.game.gameWidth-this.width)&&(this.speedX*=-1)}fire(t){let i=t-this.lastFired,s=this.position.x+this.width/2>=this.game.player.position.x-5&&this.position.x+this.width/2<=this.game.player.position.x+this.game.player.width+5;i>=this.fireRate&&s&&(this.game.addGameObject(new e(this,!0)),this.lastFired=t)}update(t){this.move(),this.fire(t)}draw(t){t.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}class s{constructor(t,e){document.addEventListener("keydown",(i=>{switch(i.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"Escape":e.togglePause();break;case" ":e.gameState==o.MENU?e.start():e.gameState==o.RUNNING&&(t.firing||t.fire());break;case"x":e.gameState!==o.GAMEOVER&&e.gameState!==o.WON||e.restart();default:return}})),document.addEventListener("keyup",(e=>{switch(e.key){case"ArrowLeft":t.speed<0&&t.stop();break;case"ArrowRight":t.speed>0&&t.stop();break;case" ":t.firing&&(t.firing=!1);default:return}}))}}class h{constructor(t){this.game=t,this.width=179*.3,this.height=56.4,this.image=document.getElementById("jet"),this.moveSpeed=5,this.speed=0,this.reset()}reset(){this.position={x:this.game.gameWidth/2-this.width/2,y:this.game.gameHeight-this.height-20},this.firing=!1,this.ammo=20,this.lives=3}moveLeft(){this.speed=-this.moveSpeed}moveRight(){this.speed=this.moveSpeed}fire(){if(this.firing||this.ammo<1)return;this.firing=!0;const t=new e(this);this.game.addGameObject(t),this.ammo-=1}stop(){this.speed=0}update(){this.position.x+=this.speed,this.position.x<=0?(this.position.x=0,this.speed=0):this.position.x>=this.game.gameWidth-this.width&&(this.position.x=this.game.gameWidth-this.width,this.speed=0),this.lives<=0&&(this.game.gameState=o.GAMEOVER)}draw(t){t.drawImage(this.image,this.position.x,this.position.y,this.width,this.height),t.fillStyle="rgba(200,10,90, 1)",t.fillRect(this.position.x,this.position.y+this.height,this.width*this.lives/3,8),t.strokeStyle="rgba(200, 10, 90 , 1)",t.strokeRect(this.position.x-1,this.position.y+this.height-1,this.width+2,10)}}class a{constructor(t){this.game=t,this.position={x:t.gameWidth-125,y:10},this.size={w:120,h:60}}update(t){}draw(t){t.strokeRect(this.position.x-1,this.position.y-1,this.size.w+2,this.size.h+2),t.fillStyle="white",t.fillRect(this.position.x,this.position.y,this.size.w,this.size.h),t.font="italic 14px Arial",t.fillStyle="green",t.textAlign="left",t.fillText(`Score: ${this.game.score}`,this.position.x+10,this.position.y+35),t.font="italic 14px Arial",t.fillStyle="orangered",t.textAlign="left";let e=[...Array(this.game.player.lives)].map((t=>"‚ù§ "));t.fillText(`Lives: ${e.join("")}`,this.position.x+10,this.position.y+15),t.font="bold 12px Arial",t.fillStyle="black",t.textAlign="left",t.fillText(`Ammo: ${this.game.player.ammo}`,this.position.x+10,this.position.y+55)}}const o={PAUSED:0,RUNNING:1,MENU:2,GAMEOVER:3,WON:4},l=new class{#t=[];constructor(t,e){this.gameWidth=t,this.gameHeight=e,this.player=new h(this),this.enemies=[],new s(this.player,this),this.gameState=o.MENU,this.levelScore=2500}addGameObject(t){this.#t.push(t)}togglePause(){this.gameState=o.PAUSED}generateEnemies(){for(let t=0;t<3;t++){const t=new i(this);this.enemies.push(t)}}start(){this.addGameObject(this.player),this.addGameObject(new a(this)),this.gameState=o.RUNNING,this.score=0,this.generateEnemies()}restart(){this.gameState=o.RUNNING,this.score=0,this.player.reset(),this.enemies=[],this.generateEnemies()}endGame(){this.gameState=o.GAMEOVER}update(t){this.gameState===o.RUNNING&&(this.#t.forEach((e=>e.update(t))),this.#t=this.#t.filter((t=>!t.markedForDeletion)),this.enemies.forEach((e=>e.update(t))),this.enemies=this.enemies.filter((t=>!t.markedForDeletion)),this.enemies.length<1&&this.score<this.levelScore&&(console.log("enemy refill fullfilled!"),this.generateEnemies()),this.score>=this.levelScore&&(this.gameState=o.WON))}draw(t){this.gameState===o.RUNNING?(this.#t.forEach((e=>e.draw(t))),this.enemies.forEach((e=>e.draw(t)))):this.gameState===o.GAMEOVER?(this.#t.forEach((e=>e.draw(t))),function(t,e){t.fillStyle="rgba(255, 255, 255, .9)",t.fillRect(0,0,e.gameWidth,e.gameHeight),t.fillStyle="red",t.fillRect(0,e.gameHeight/2-20,e.gameWidth,60),t.font="bold 16px Arial",t.fillStyle="white",t.textAlign="center",t.fillText("GAME OVER!",e.gameWidth/2,e.gameHeight/2+8),t.fillText("Points: "+e.score,e.gameWidth/2,e.gameHeight/2+25)}(t,this)):this.gameState===o.WON?function(t,e){t.fillStyle="rgba(255, 255, 255, .9)",t.fillRect(0,0,e.gameWidth,e.gameHeight),t.fillStyle="blue",t.fillRect(0,e.gameHeight/2-20,e.gameWidth,60),t.font="bold 16px Arial",t.fillStyle="white",t.textAlign="center",t.fillText("WON!!",e.gameWidth/2,e.gameHeight/2+8),t.fillText("Points: "+e.score,e.gameWidth/2,e.gameHeight/2+25)}(t,this):this.gameState===o.MENU&&function(t,e){t.fillStyle="rgba(0, 100, 255, 1)",t.fillRect(0,0,e.gameWidth,e.gameHeight),t.fillStyle="orangered ",t.fillRect(0,e.gameHeight/2-20,e.gameWidth,60),t.font="bold 16px Arial",t.fillStyle="white",t.textAlign="center",t.fillText("SPACE JET FIGHTER",e.gameWidth/2,e.gameHeight/2+5),t.fillText("Press SPACE to start!",e.gameWidth/2,e.gameHeight/2+30)}(t,this)}}(600,450),r=document.getElementById("stage").getContext("2d");requestAnimationFrame((function t(e){r.clearRect(0,0,600,450),l.update(e),l.draw(r),requestAnimationFrame(t)}))})();